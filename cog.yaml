build:
  gpu: true
  cuda: "12.1"
  python_version: "3.11"
  system_packages:
    - "git"
    - "wget"
    - "libgl1-mesa-glx"
    - "libglib2.0-0"
    - "libsm6"
    - "libxext6"
    - "libxrender-dev"
    - "ffmpeg"
    - "libgomp1"
  python_packages:
    - "torch>=2.0.0"
    - "torchvision"
    - "numpy<2"
    - "Pillow>=9.0"
    - "scipy>=1.11.0"
    - "imageio>=2.31.0"
    - "plyfile"
    - "tqdm"
    - "einops"
    - "timm"
    - "huggingface_hub"
    - "pillow_heif"
    - "matplotlib"
    - "opencv-python-headless"
    - "trimesh"
    - "open3d"
    - "safetensors"
    - "moviepy==1.0.3"
    - "e3nn"
    - "omegaconf"
    - "gsplat"
    - "click"
  run:
    - "git clone https://github.com/apple/ml-sharp.git /opt/ml-sharp"
    - "rm -f /opt/ml-sharp/.python-version"
    - "cd /opt/ml-sharp && pip install -e . --no-deps"
    - "python -c 'from sharp.models import create_predictor, PredictorParams; print(\"Sharp model imports OK\")'"
    - "mkdir -p /opt/sharp-models && wget -q https://ml-site.cdn-apple.com/models/sharp/sharp_2572gikvuh.pt -O /opt/sharp-models/sharp_2572gikvuh.pt"
predict: "predict.py:SharpPredictor"
